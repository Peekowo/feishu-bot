import requests
import random
import os
import json

# 您的100条消息列表
messages = [
    "我家门前有两份日报，一份是枣日报，另一份也是枣日报。",
    "日报是一袭华美的袍，爬满了蚤子。",
    "月光如银子，无处不可照及，山上篁竹在月光下皆成为黑色，日报也静静躺在那儿。",
    "祥子的脸通红，手哆嗦着，拍出九十六份日报来：‘我要这份！’",
    "走在天上，走在寂静里，而日报倒挂下来。",
    "从前的日色变得慢，车，马，邮件都慢，一生只够爱一份日报。",
    "筷子头一扎下去，吱——日报就冒出来了。",
    "她只穿绯霞色抹胸，海蓝色贴肉短裤，镂空白皮鞋里露出涂红的指甲，日报安静地躺在桌上。",
    "满纸荒唐言，一把辛酸泪。都云作者痴，谁解其中日报？",
    "死是一件不必急于求成的事，日报是一个必然会降临的节日。",
    "多年以后，面对行刑队，上校将会回想起父亲带他去见识日报的那个遥远的下午。",
    "镜子与交媾都是污秽的，因为它们使日报的数量增加。",
    "一天早晨，格里高尔·萨姆沙从不安的睡梦中醒来，发现自己躺在床上变成了一份巨大的日报。",
    "带着点心渣的那一勺茶碰到我的上颚，顿时使我浑身一震，我注意到我身上发生了非同小可的变化：日报写好了。",
    "日报，我的生命之光，我的欲望之火。我的罪恶，我的灵魂。",
    "他是个独自在湾流中一条小船上钓鱼的老人，至今已去了八十四天，一条日报也没逮住。",
    "我唯一担心的是我们明天的生活能否配得上今天所承受的日报。",
    "透过栅栏，穿过攀绕的花枝的空档，我看见他们在写日报。",
    "河流穿过，介于陡峭的码头、啤酒色、褐色的日报旁。",
    "我的家族成员只有两种人：要么是和我一起住过的人，要么是想要住进来的人，而日报属于他们。",
    "百分百的女孩和百分百的男孩，在四月一个美好的早晨，在街角不期而遇的，是一份日报。",
    "他觉得海面像一匹硕大无朋的蓝绸，威风凛凛地翻动着，而日报漂浮其上。",
    "我已经老了。有一天，在一处公共场所的大厅里，有一份日报向我走来。",
    "于是我想，一份日报可以成为另一个人的天堂。",
    "时间是上帝赐给人类的宝贵礼物，但日报也是一条循环往复的怪蛇。",
    "天气好极了，钱几乎没有，日报却依旧在桌上。",
    "在那年秋季枯燥，灰暗而瞑寂的某个长日里，日报静静躺着。",
    "达洛维夫人说她自己去买花，而我打开了日报。",
    "竹林深处，发现了一份日报。",
    "我们不会停止阅读，即使每本书总有读完的时候，如同我们不会停止生活，即使日报必然到来。"
]


def send_to_feishu(message):
    webhook_url = os.getenv('FEISHU_WEBHOOK_URL')
    
    if not webhook_url:
        print("错误：未找到飞书Webhook URL")
        return False
        
    payload = {
        "msg_type": "text",
        "content": {
            "text": message
        }
    }
    
    try:
        response = requests.post(webhook_url, json=payload, timeout=10)
        if response.status_code == 200:
            print("消息发送成功！")
            return True
        else:
            print(f"发送失败，状态码：{response.status_code}")
            print(f"响应内容：{response.text}")
            return False
    except Exception as e:
        print(f"请求出错：{e}")
        return False

if __name__ == "__main__":
    # 随机选择一条消息
    random_message = random.choice(messages)
    print(f"选中消息：{random_message}")
    
    # 发送到飞书
    success = send_to_feishu(random_message)

    exit(0 if success else 1)
